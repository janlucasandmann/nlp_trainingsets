
fMRI-based Static and Dynamic Functional Connectivity Analysis for Post-stroke Motor Dysfunction Patient: A Review
Kaichao Wu1,2, Beth Jelfs3, Katrina Neville2 and John Q. Fang1*
 
Abstract
Functional magnetic resonance imaging (fMRI) has been widely utilized to study the motor deficits and rehabilitation following stroke. In particular, functional connectivity(FC) analyses with fMRI at rest can be employed to reveal the neural connectivity rationale behind this post-stroke motor function impairment and recovery. However, the methods and findings have not been summarized in a review focusing on post-stroke functional connectivity analysis. In this context, we broadly review the static functional connectivity network analysis (SFC) and dynamic functional connectivity network analysis (DFC) for post-stroke motor dysfunction patients, aiming to provide method guides and the latest findings regarding post-stroke motor function recovery. Specifically, a brief overview of the SFC and DFC methods for fMRI analysis is provided, along with the preprocessing and denoising procedures that go into these methods. Following that, the current status of research in functional connectivity networks for post-stoke patients under these two views was synthesized individually. Results show that SFC is the most frequent post-stroke functional connectivity analysis method. The SFC findings demonstrate that the stroke lesion reduces FC between motor areas, and the FC increase positively correlates with functional recovery. Meanwhile, the current DFC analysis in post-stroke has just been uncovered as the tip of the iceberg of its prospect, and its exceptionally rapidly progressing development can be expected.
Keywords: Stroke; Functional Connectivity; Static Functional Connectivity analysis; Dynamic Functional Connectivity analysis
* Correspondence:
qiangfang@stu.edu.cn 1Department of Biomedical Engineering, College of Engineering, Shantou University, Shantou, P.R.China
Full list of author information is available at the end of the article
Introduction
According to the report on Global Burden Disease [1], stroke is the second leading cause of death and the second largest cause of disability. In a global world, there were 101 million stroke cases and 13.7 million new stroke survivors [2] in 2019, which is nearly five times that of 2013. As more than 60% of the survivors are left with severe sequela, stroke has become the largest known cause of complex disability [3], and 77% of stroke survivors suffer from slow upper limb/hand movement disorder [4].
There are multiple causes for the quintupling of survivors in such a short period of time, including ageing, growing populations,improved post-stroke care, increased risk factors, to name a few. [2]. With the sharp growth of stroke survivors, effective post-stroke rehabilitation seems to be great necessary. Various restorative thera- pies can assist stroke survivors in improving their motor function deficits. They
arXiv:2301.07171v1 [q-bio.NC] 15 Dec 2022
Wu et al.
Page 2 of 25
mainly include (i) dynamic splints-based therapy (e.g., physiotherapy, restraint- induced kinesiotherapy, gait therapy) [5, 6], (ii) electrical muscle stimulation (EMS) therapy [7, 8], (iii) device-driven therapy (e.g., robotics, brain-machine interfaces (BCI)) [9, 10, 11, 12], (iv) transcranial magnetic stimulation therapy (TMS) [13, 14], and (v) mirror therapy [15, 16]. The prospects for these therapies seem bright. The hand function, for example, shows signs of recovery even during the chronic recovery phase [11]. However, the effectiveness of these rehabilitation measures varies from individual to individual. Not every patient recovers their limbs to some extent after a stroke;and even for individuals with identical levels of initial functional impair- ment, the rehabilitation effects vary greatly among people [17, 18]. Many unknown factors influence the outcome of recovery [19, 20]. Since the lesions that results in post-stroke disability are located in the brain, to gain insight into these factors, it is crucial to comprehend the process in the brain when function recovery occurs.
Emerging evidence has revealed that post-stroke recovery is a time-depended pro- cess. The interrupted connectivity within the central nervous system reorganizes in structure and function over time to adapt to damage caused by a stroke. Hence, a lot of cross-sectional and longitudinal study has been carried out recently to gain insight into this process. By taking advantage of the dynamic alteration of the brain connectivity network, the behaviour of the brain system can recognize, for instance, how recovery adapts structurally and functionally over time and how this adaptation underpins functional recovery [21]. In addition, the structure or function connectivity dynamics in brain network reorganization can help reveal what factors promote or impede the recovery process, thus informing more productive interven- ing therapies in accordance with this neural network modulation and ultimately facilitating greater rehabilitation programs.
Structurally, stroke lesions are considered one of the most important factors that cause network disconnection. Interestingly, after stroke, the lesion-surrounding re- gions can bypass the damage and rebuild connections to support the patient relearn the lost function [20]. For example, one study by [22] has demonstrated that the corticospinal tract (CST) connecting the cerebellum and the primary motor cortex will be generated after stroke, and the newly found physical connections are asso- ciated to skillful motor control. As a pathway connecting the motor cortex with motor neurons projecting from the spinal cord, CST plays an essential role in the motor control system [23]. Once CST is damaged following stroke, the alternative pathways will be recruited to compensate for the lost connections [22] and thus result in further change in structure connectivity [24, 25]. Beyond impairing local physic connectivity, a stroke lesion can also alter the neural interaction between di- rectly or indirectly connected brain areas [26]. This interaction (or communication) is shown with functional collaboration between brain regions, which is also referred to as Functional Connectivity (FC) [27]. Over past few decades, the changes in func- tional network architecture during stroke recovery have been continually reported. A common finding in numerous studies looking at post-stroke FC is the decreased interhemispheric FC at the initial stage after stroke. Yet, this abnormal FC will develop and return toward the nearly ordinary level [28, 29, 30]. And this gradually enhanced FC is demonstrated to favorably correlate with motor recovery in the subacute or chronic phase [31, 32, 29].

Wu et al.
Page 3 of 25
Since functional connectivity has become an essential metric in neuroscience related to stroke recovery, a variety of means recording the brain activity have been utilized to explore the brain functional connectivity pattern, including EEG(Electroencephalography), MEG (Magnetoencephalography), and fMRI (Func- tional Magnetic Resonance Imaging). EEG and MEG measure the FC by recording the electromagnetic neural activity, whilst fMRI achieves this target by measuring the consistency of the blood oxygenation level-dependent (BOLD) signals across brain regions over time.
Among these methods, the fMRI is a well-liked non-invasive imaging method due to its high spatial-temporal resolution [20, 33]. However, whether the connection is evaluated at rest or when doing a task is a crucial factor that cannot be overlooked in post-stroke FC analysis with fMRI. According to the observations across studies, these two ways often produce variable results. Resting-State (RS)-fMRI has certain advantages compared with task-based fMRI. The first is that studies with RS-fMRI do not need to design the movement paradigm and quantify the motor executive performance, while that is hard part across studies with task-based fMRI and can be greatly diverse. Measure task performance, for example, in hand grip task [34] and hand movement task [35] are different. And importantly, RS-fMRI provides a unified manner for comparison between studies, thus facilitating further under- standing of recovery mechanisms. yet, the discovered recovery mechanisms in the study with task-based fMRI may be only effective in particular tasks. Therefore, this review concentrates on research employing rest-state fMRI to examine brain functional connectivity following stroke. In addition, when analyzing the function connectivity from the perspective of the method processing the RS-fMRI data, the distinction between the studies is the time scales over which the brain function connectivity evolves. Conventional methods assume that the FC measures are sta- tionary over a full MRI scan, while it has shown that the FC fluctuates even over the seconds [36] [37] and the static FC network is too simplistic to capture the com- plete representation of FC evolution [38]. Recently, a growing number of methods have been introduced to explore dynamic functional connectivity following stroke and made an effort to bring an all-new perspective to investigate the recovery mech- anism.
In 2011, the longitudinal changes of resting-state functional connectivity during motor recovery after stroke have been evaluated [27]. The dynamic development of brain connectivity after stroke in 2018 has also been documented [21]. How- ever, a review concentrating on post-stroke functional connectivity analysis from the standpoint of the techniques has not yet provided a summary of the most re- cent findings. Hence, this review attempts to provide overview of the latest progress in the changes to brain motor functional architecture following stroke from the per- spective of static and dynamic functional networks(SFC and DFC). By synthesizing the present understanding of functional networks in the resting state from various viewpoints, this review can provide potential method guides and feasible references to map the post-stroke neuroplasticity of brain circuits. Additionally, the compre- hension of resting-state functional network under different analysis methods can provide viable guidance in designing dynamic neural rehabilitation interventions to benefit stroke patients.

Wu et al.
Page 4 of 25
Methodology
literature search
The literature search was restricted to English-language articles published between January 2000 and May 2022 in the following electronic databases: PubMed, Web of Science, IEEE Xplore, ScienceDirect, MEDLINE (OvidSP), CDSR (Cochrane database of systematic reviews), Scopus, Compendex, Wiley Online Library, Aca- demic Search Premier, and Springer Link. The electronic search terms were Stroke AND fMRI AND Functional Connectivity AND Motor deficit AND Rehabilitation. Studies that include task-related fMRI and involve effective connectivity and beyond motor function were excluded. Besides, this review included studies that explore the development of functional connectivity analysis methods. Particularly, those stud- ies that employ these approaches for post-stroke motor function impairment and rehabilitation have been covered.
Terms and definition
Post-stroke stage
Throughout this review, the terms: acute, subacute and chronic stages refer to the three phases of recovery after stroke. The timeline of these phases, which spans from the time of the initial stroke to years afterward, is summarized in Figure 1. Their definition is in accordance with the recommendation of [39] and previous studies in stroke rehabilitation programs [40, 41].
Functional Connectivity(FC), Functional Network Connectivity(FNC) and Functional Connectivity Network(FCN)
The terms Functional Connectivity (FC), Functional Network Connectivity (FNC), and Functional Connectivity Network (FCN) are frequently used by the authors in the studies reviewed in this paper. These nouns are so similar that the readers risk becoming confused if they are not attentive. Here, FC is defined as correla- tion (or other statistical dependencies) among spatially remote brain regions [42]. The process of inferring functional connectivity among multiple brain regions by calculating pairwise correlation is summarized in Figure 2(a). FNC can be seen as a higher level FC, which refers to a statistical dependency among large-scale func- tional networks (or functional domains) in the brain [43], for example, the default mode network(DMN) [44]and sensorimotor network (SMN) [45]. A representation of brain regions that the involved in functional networks may be found in Figure 2(b). If with no specific statement, the FC and FNC refer to a pairwise Person’s correlation in this review. By contrast, Functional Connectivity Network (FCN)
    Figure 1 The phase of post-stroke recovery stages
 
Wu et al.
Page 5 of 25
    Figure 2 (a). Inferring functional connectivity among multiple brain regions by calculating pairwise correlation; FCN: a functional connectivity graph can be generated where the vertices represent the brain regions and the edges represent the strength of FC/FNC between these regions. (b) The large-scale functional networks: the default mode network (DMN), which involves the medial prefrontal cortex (MPFC), posterior cingutate( PCC), bilateral hippocampus; and the sensorimotor network (SMN), which includes supplementary motor areas (SMA), primary motor cortex (M1), primary sensory area(S1), posterior parietal cortex (PPC).
 is a concept based on FC and FNC. It refers to a functional connectivity graph where the vertices represent the brain regions and the edges represent the strength of FC/FNC between these regions.
Motor recovery measurement
Clinically, motor recovery after stroke is measured by the absolute difference be- tween baseline and subsequent motor function scores [46]. This can be best achieved by comparing the motor function assessment at longitudinal time points. In the studies reviewed in this paper, there are several methods used by the authors to eval- uate the post-stroke motor function, including the(FMA)scale [47], which evaluates patients’ single-joint and multi-joint motor ability, loss of co-motor energy, finger in- dividualization ability, movement speed, measurement impairment, ataxia, and mo- tor reflex, and the Paralysed Hand Function Assessment Scale [48]which measures the degree of paralysed hand for stroke patients. Other evaluation methods include the Action Research Arm Test (ARAT) [49] Modified Rankin Score(mRC) [50]. etc.
Beyond that, comparing the post-stroke recovery stages that the stroke patients in at different time points can helps demonstrate the motor recovery process. One of the most well-known methods of measuring the stroke recovery stages is the Brunnstrom stages, also known as the Brunnstrom approach [51]. By classifying the assessment score into distinct zones, the National Institutes of Health Stroke Scale (NIHSS) or the evaluation scale indicated above are widely used to estimate

Wu et al.
Page 6 of 25
the patient’s stroke recovery stages. This partition can also be utilized to divide the patient sample into subgroups affected by stroke. Hence, in many cross-sectional studies, the relationship between the FC and motor recovery can be investigated by examining the FC alteration between different groups [52, 53, 54, 55]
fMRI processing for DFC and SFC
Preprocessing and denoising RS-fMRI
By sampling the brain’s three-dimensional (3D) volume every 1-2 s (or faster), MRI scanning can obtain the brain landscape map at the millimetric spatial resolution. Then, the BOLD signal contrast can be extracted within a full MRI scan. The BOLD signal variance can represent the resulting brain neural activity through multivariate time series. As the BOLD signal is weak and suffers from the noise of multiple sources, the raw fMRI data needs to undergo extensive pre-processing before further analysis. Pre-processing of rs-fMRI signals included the following steps:
1 removing a number of volume from the beginning for steady BOLD signal (typically, 3 [56] or 10 [57]);
2 slice timing correction
3 realignment for head motion
4 outlier detection for scrubbing;
5 registration to structural images, segmentation [58] and lesion-masked nor-
malization [59];
6 spatial smoothing using a full-width at half-maximum (FWHM) Gaussian
kernel (4 or 8 mm for the recommendation).
Note that this is a general possible pre-processing pipeline. The processed methods and their orders for the studies can be varied across specific applications and tasks.
Despite the pre-processing processes’ capacity to remove the majority of brain activity disturbances, the BOLD signal often still contains considerable noise or non-neural variability due to a combination of a physiological, outlier, and residual subject-motion effects [60, 61, 62]. These residual noise components in the BOLD signal will introduce strong and observable biases in all functional connectivity measures. Therefore, there are typically additional strategies to remove or at least minimize these underlying interferences in the context of functional connectivity. These strategies generally refer to denoising step, which include linear regression of potential confounding effects (e.g. effect from the gray matter, white matter, and cerebrospinal fluid) in the BOLD signal, linear detrending, temporal band-pass fil- tering. Similarly, the denoising strategies has not gold standards, they are variable across the studying methods and tasks. Figure 3 A and B exhibit various prepro- cessing steps and denoising strategies. One note that nearly all studies reviewed in this paper introduce the preprocessing step, while the denoising step has been not be emphasised. The denoising step has been proved that it can benefit FC estima- tion by improving the signal quality and reducing the motion artefacts [61]. Hence, these additional denoising strategies should be encouraged to gradually introduce into stroke studies, which probably can enlarge the variability in FC alteration caused by stroke and then promote more reliable and accurate results.

Wu et al.
Page 7 of 25
Several existing open-source tools can perform the pre-processing and denois- ing steps and enable the analyzable fMRI to be obtained reliably and rapidly, in- cluding the Statistical Parametric Mapping software package (SPM), the FMRIB Software Library (FSL) [63], the Data Processing Assistant for Resting-State fMRI (DPARSF) [64], CONN toolbox [60], the graph-theoretical network analysis toolbox (GRETNA) [65].
Time series extraction
After the raw RS-fMRI has been pre-processed and denoised, the time course of the brain areas during the fMRI scan has to be extracted for further post-stroke functional connectivity analysis. The methods for time series extraction are mainly divided into two categories: ROI-based and data-driven methods.
The ROI-based method relies on predefined regions of interest (ROI) to extract the time course of brain areas. As the motor control region in the brain system, nearly all investigations linking to post-stroke motor active recovery covert the primary motor cortex (M1) as one of their ROIs. Meanwhile, Supplementary Motor Area (SMA) is frequently investigated as an ROI. The decreased connectivity between M1 and SMA has been found across studies in stroke patients. Beyond M1 and SMA, other regions, including the premotor cortex, and inferior frontal gyrus, are also predefined as ROI to investigate the inter-regional abnormal connectivity following stroke. In addition to manually set regions, the anatomical atlas is often used to identify ROIs. There are typically three anatomic atlases utilized to define brain regions: Destrieux [66], Harvard-Oxford [67] and AAL [68] atlas(see Figure 3 C for the three anatomical atlas).
Data-driven method, by contrast, does not need to pick brain seeds beforehand, and it is free from prior knowledge of specific brain regions. Specifically, it uses multivariate voxel-wise projection techniques such as independent component anal- ysis (ICA) or its variants (e.g., group ICA) to decompose the raw fMRI data into multiple independent components (ICs). Each IC represents the brain areas with independent brain activity. Figure 3 C shows the diagram of the spatial ICA based
    Figure 3 The pipeline of fMRI processing for SFC and DFC analysis.A.Preprocessing functional images B. Denoising functional images. C.Atlases based and Spatial ICA based time series extraction D1. SFC analysis. D2. Sliding window based DFC analysis
 
Wu et al.
Page 8 of 25
timeseries extraction method. Then, these ICs will be visually inspected to identify if the brain areas they represent can have brain activity because of a nerve action or if this activity is just caused by noise.The spatial map of IC with true brain activity can be matched with the previous anatomic brain function map.Meanwhile, their power-frequency curve has a specific fluctuating pattern(peak at low frequency, de- crease rapidly, and then remain relatively stable). The identified ICs were recognized as intrinsic connectivity networks(ICN) which can be utilized for further functional connectivity analysis between functional areas or high-level functional connectivity between brain functional domains(e.g., the default mode, sensorimotor, subcortical, and cerebellar functional network).
Static and dynamic functional connectivity estimation
Static functional connectivity estimation
Typically, SFC estimates functional connectivity between two brain regions by cal- culating the pairwise correlations between their time series. In the case of fMRI analysis, this correlation is frequently quantified with a canonical correlation coeffi- cient [69, 70, 71] that measures the similarity of amplitudes of BLOD fluctuations. There are also studies using the indices-based phase coupling measure, including the coherence [72] or phase-locking relationships [73]. The pairwise correlations be- tween region nodes or functional domains can construct a Functional Connectivity Network (FCN) representing the brain’s functional connectivity profile. Usually, be- fore performing the group-level FC analysis, the individual correlation-based FC is often transformed to a normalized distributed Z-score using Fisher’s r-to-Z trans- formation, as it will not be bounded by upper or lower limits, which is helpful for further statistical analysis.
Based on the pairwise correlations, many SFC analysis methods exist, such as the FCN density analysis method [74], the Regional homogeneity (ReHo) based approach [75] and Kendall correlation coefficient (KCC) approach [76]. In addition, considering the investigated brain regions as nodes and the pairwise correlations as edges, the functional connectome can be viewed as an adjacency matrix or graph. Hence, the FCN can be naturally analysed with graph-based methods. For example, the clustering coefficients, global efficiency and local efficiency of the FNC graph can be calculated with graph theory [77], and these graph-based measures can be integrated to analyze the functional connectivity of the brain.
Dynamic functional connectivity estimation
The development of DFC analysis for RS-fMRI is incited by the fact that the FC/FNC between regions or voxels may change in a short period [78]. Accumulating evidence has demonstrated that the FC/FNC alternation follows certain functional coupling patterns over time [79, 80], and these fluctuating coupling patterns support the brain regions in processing different functional requirements [80].
A multitude of approaches to quantify these dynamic patterns and their properties have been introduced (the detailed review related to dynamic functional connectiv- ity can be seen in [81, 80, 82, 38]). The most common and straightforward way to measure the DFC is by calculating the FC/FNC between regions/voxels in a consecutive window period. The window length is usually constant, and the sliding

Wu et al.
Page 9 of 25
scheme spanning the full scan is run. The length of the sliding step is generally less than the window length; thus, two adjacent windows can partially overlap. With the sliding window method, thousands of FC/FNC matrices can be generated at the window length level. These successive matrices exhibit the dynamic evolu- tion of brain state within an MRI scan duration, and thus, the fluctuations in the connectivity time courses can be easily assessed. The measurements to quantify the fluctuation include the temporal standard deviation [83, 84, 85], coefficient of variation [86], or amplitude of low-frequency fluctuations (ALFF) [87, 88]. In addi- tion, the matrix factorisation techniques can summarise a series of FNC patterns into multiple FNC states. The recurrent or repeating connectivity patterns/states represent the underlying functional coupling patterns. The typical method to sum- marize the connectivity patterns is K-means clustering [89], which has been widely used in fMRI studies for DFC analysis since a study by Allen et al [90]. The cluster- ing approach reveals the reoccurring connectivity patterns from the windowed FC matrices, and the dynamic brain states corresponding to ongoing processing can be reflected.
Another representative approach summarising the brain state is the innovation- driven co-activation patterns (iCAPs) method [82]. iCAPs method does not rely on the sliding window scheme but needs a clustering algorithm’s assistance. It identifies BOLD signals’ transients (or innovation frames) and feeds them into clustering methods to obtain iCAPs [38, 91]. Besides, there are also other DFC methods, such as the principal component analysis (PCA) method [92], the dictionary learning (DL) method [93, 94], the tensor decomposition(TE) methods [95], the dynamic community detection based method [96, 97], the Hidden Markov Model(HMM) [98] method and the wavelet transform coherence (WTC) method [99]. However, in studies about post-stroke motor dysfunction, these methods are rarely investigated for DFC analysis.
SFC and DFC comparison
In principle, the SFC method assumes that FC/FNC is stationary over MRI scan time, and the functional connectivity is constant during a MRI scan. Neverthe- less, SFC ignores that the human brain is a dynamic system that fluctuates even at the time scale of milliseconds [100]. Therefore, DFC analysis approaches devel- oped rapidly in the last decade to investigate the dynamic nature of the brain. In methodology, the SFC analysis approaches are just based on the average FC/FNC that aggregates over an entire fMRI scan. Despite SFC’s methodological simplicity and ease, SFC approaches can vividly show the disease-induced FC alterations. This is particularly important when investigating the damage’s impact on the specific brain functional area. For example, many post-stroke studies have employed SFC to investigate the stroke-lesion caused FC changes and to verify if the post-stroke FC reorganization can underpin functional recovery [52, 53, 54, 55, 101, 31, 28]. For that reason, the SFC can provide a valuable reference to functional rehabilitation programs. Many disease treatments have utilized invasive or non-invasive tools (e.g. the transcranial magnetic stimulation [30, 102]) in clinical trials to help the affected brain motor function areas promote recovery [103].
By contrast, DFC analysis approaches employ time-resolving or signal decompo- sition methods to investigate a time-varying FC/FNC that span the fMRI scan. It

Wu et al. Page 10 of 25
Table 1 SFC and DFC comparison.
- Definition Methods Pros Cons
    SFC
 FC keeps static in fMRI scan
 Pairwise correlation; Mature application; FCN density [74]; Brian region focused; Regional homogeneity[75]; Vivid FC alteration; Graph theory [77]; Applied in clinical trials.
  Methodological simplicity and ease; Ignore brain
FC dynamics.
  DFC
 FC continuously flactuates
 Sliding window [90]; PCA method [92];
DL method [93, 94] TE method [95];
DCD method [96, 97]; HMM [98];
WTC [71] ;
  Increased temporal-spatial resolution;
Reflective network flexibility;
Exhibitaion of brain state transitions
Complicated mathematics [46]; Sensitive to noise;
  can extract relevant dynamic features to reflect functional network flexibility and brain state transition. However, despite this potential of dynamic FC analysis, only a handful of studies have employed such time-resolved approaches to explore the dy- namic neural mechanism following stroke. In contrast to the thrive research of SFC methods in other neurological diseases such as Parkinson’s disease [104] and Hunt- ington’s disease [105], DFC analysis on rs-fMRI following stroke is still developing. Besides, compared with SFC analysis, DFC approaches typically have a complicated mathematical/probability theories [46](e.g., the HMM-based DFC analysis [98]). Hence, DFC is probably not friendly to those clinicians without mathematical or engineering backgrounds. Furthermore, due to increased fMRI temporal-spatial res- olution, the DFC is more sensitive to noise [80, 38]. Thus, the extra hype-parameter setup (e.g., the window length and sliding step in the sliding-window DFC method) needs to be fine-tuned to verify the validity of the results [81, 80].
Overall, SFC and DFC both have advantages and disadvantages(summarized in Table 1). Compared with DFC, SFC analysis is more mature and has more appli- cations in post-stroke fMRI analysis; however, the DFC analysis can capture the intrinsic dynamic nature of the brain, which shows a potential promising prospect. Even though DFC models can rarely be seen in post-stroke studies currently, they are expected to boom in the future of post-stroke investigation.
Static connectivity analysis
Decreased functional connectivity is a common finding
In numerous rehabilitation studies estimating resting-state FC, a decrease in inter- hemispheric FC was commonly found in the functional network or at least between some regions by comparing results from stroke patients with healthy controls. This reduction is caused by the disruptions in multiple large-scale functional brain net- works, which has been viewed as one of the characteristics of motor impairment following stroke [28].
In detail, the lowest level of FC appears in the acute phase of stroke, and the earli- est time of this finding is within a few hours post-stroke. Hence, interhemispheric FC reduction is often reported in many studies studying FC in acute ischemic stroke pa- tients. For example, Liu et al. [74] observed disrupted interhemispheric FC between

Wu et al.
Page 11 of 25
the motor cortices of acute stroke patients, which was associated with motor deficits. A recent study investigating dynamic structural and functional reorganizations fol- lowing motor stroke reported a significantly lower interhemispheric FC in the first week [106]. This decrease in interhemispheric connectivity is more distinct than those in intrahemispheric connectivity. In addition, Nai-Fang et al [107] observed decreased interhemispheric FC within the cortical motor network in the first acute unilateral ischemic stroke patients. Specifically, the FC between the ipsilesional M1 and contralesional M1, contralesional postcentral gyrus (PoCG), dorsolateral PMC are significantly lower than that in controls. Besides, the interhemispheric FC re- duction can also be observed in the post-stroke subacute and chronic stages. In [31], the FC between M1 and the contralateral cerebral cortex was reduced in stroke pa- tients with unilateral ischemic motor neural network injury 2 weeks after onsets. And the stroke participants recruited by [57] showed a decreased FC between the ipsilesional SMN and the contralesional SMN and auditory network (AN), which supports the early findings in the [108] that the disruption of interhemispheric in- teractions between bilateral SMNs may result in motor deficits in patients with chronic stroke.
Beyond interhemispheric FC, the decreased contralesional M1 FC can be found in a study [109]. The lowest FC levels in the contralateral sensorimotor cortex are 2 weeks after stroke. The [110] reported the reduced within-network FC in the contralesional precentral gyrus within the dorsal sensorimotor network and the contralesional superior parietal lobe.
Brain functional connectivity network topology supports the decreased FC
Brian functional connectivity network (FCN) can be described as a set of nodes (ROIs or independent components ) connected with edges (functional connectivity measure). Thus, graph theory analysis on FCN can provide important information about the topological properties of the brain functional network. When analyzing FC from the perspective of a brain graph, the various FC network topology measures also approve of the reductions in FC in contrast to a healthy brain.
For the local topological measure of the FC graph, a study has proved the shortest path length to be lower than healthy controls in acute ischemic stroke [111]. And the clustering coefficient was reported to decrease [112, 113, 114], though [111] suggested that stroke patients maintained the local clustering coefficient. In addition, another local measure, the weighted node degree which measure the number of connections has been found to decrease in the contralesional M1 of patients with bad recovery post-stroke [115].There are no significant finding in topological measures between patient and control was reported in other studies [114] following stroke.
Regarding the global topological measure of FCN, a reduction in network modu- larity was observed in an experiment including 25 patients with focal lesions because of stroke [116]. This finding was consistent with the decrease in interhemispheric function integration. Modularity measured by the connection density within com- munities over that between communities reflects the degree of functional integration and segregation [117]. A recent study supported the findings in [118], where signif- icantly lower modularity was found in patients compared with controls, indicating decreased segregation in the FNC. Beyond modularity, other global measures of

Wu et al.
Page 12 of 25
the FC network tended to decline. In [114], the FC concordance, which measures the network stability in time, was observed to decrease over time in contrast to intact networks. In addition, the small-worldness which reflects the ability of brain networks satisfying the needs of local and global information processing was signif- icantly lower in patients than controls two weeks after stroke [119].
There are a great varity of graph theory based topology measures, resulting in the dynamics patterns in the network topology investigated in studies are various. In general, the graph topology alteration of FCN post-stroke can be interpreted in a concept of network randomization [116], the way the network reorganizes itself to adapt to the lost function, which also demonstrates the process of neuroplasticity that occurs in the brain post-stroke.
Increased functional connectivity is positively related to recovery
Even though a decreased FC is a dominant trend in patients following a stroke in contrast with healthy controls, many findings also include the increased FC. Sev- eral longitudinal studies have demonstrated that the interhemispheric FC in the SMN first decreases in the early stages after stroke while increases in the following weeks or months [120, 29, 109]. Other studies support this FC-increased finding as well. For example, in a systemic study [28], the decreased FC was observed in stroke patients between the ipsilesional M1 and the sensorimotor cortex, the oc- cipital cortex, the middle frontal gyrus(MFG) and the posterior parietal cortex, while the increased FC was also shown between ipsilesional M1 and cerebellum, the thalamus, the middle frontal gyrus (MFC) and the posterior parietal cortex. Be- sides, in the study [74], although the FC in the motor area decreased after stroke, the opposite occurred in cognitive networks. In addition, a recent study [83] re- ported that compared with healthy groups, the patients exhibit a significantly in- creased static FC between a large number of structures, including ipsilesional M1 and the contralesional precentral gyrus(PrG), contralesional M1 and the ipsilesional PrG, contralesional precuneus; ipsilesional MFG and precuneus, the contralesional cerebellar, PoCG, ipsilesional sub-gyral region; SMA and ipsilesional PrG, frontal- temporal space, MFG; ipsilesional SMA and the ipsilesional middle temporal gyrus (MTG).
The increased FC post-stroke seems to be restricted between specific struc- tures [21], while the highly consistent finding is that the increased FC occurred in connectivity with the cerebellum [28, 114, 121]. This conclusion derived from a potential recovery mechanism that FC in the cerebellum was reported to be cru- cial for recovery [122, 123]. In fact, not limited to the cerebellum, many structures that found increased FC correlate with motor recovery. The commonly mentioned brain region is M1. Many studies have reported that FC increases between the ipsilesional M1 and contralesional M1 and between the ipsilesional SMC and con- tralesional SMC,which is related to better recovery [74, 124, 121]. Besides, Ktena et al. in [125] observed increased FC between lesion areas and M1 in the unaffected hemisphere of the chronic patient. They concluded that this phenomenon reveals the network reorganization process associated with motor recovery. Furthermore, the enhanced FC between M1 and SMA and other motion-related regions like the dorsolateral prefrontal cortex (PMD) has been be archived and proved that this enhancement is a potential mechanism for motor function recovery [125, 126].

Wu et al. Page 13 of 25
                                                                                                                           Table 2 The summary of studies using post-stroke rs-fMRI based static function connectivity for motor network analysis.
1
unilateral ischemic stroke
34 Longitudi- 1w, 4w, nal and 12w
Seed-based: ROIs selected in somatomotor network (SMN) along the left and right primary motor cortex (M1) Seed-based: predefined ROIs: primary motor cortex (M1), supplementary motor area (SMA), PoCG, ventrolateral PMC, and dorsolateral PMC, posterior cingulate cortex, anterior medial prefrontal cortex , inferior parietal lobule , retrosplenial cortex, and anterior hippocampus.
A significantly lower interhemispheric FC in the first week and a continual increase to week 12;
2
[107] 67
acute unilateral ischemic stoke
25 Cross- Within sectional 7d
NIHSS; mRS(90d)
Significantly lower FC between iM1&cM1,iM1&cPCG,iM1&cPMd, iPCG&cM1, iPCG&cPoCG, iP0CG&cPMd, and cM1&cPCG; FC of iM11&cM1, iM11&cPoCG, iPCG1&cM1,iM1&cPMC was significantly lower in patients with unfavorable outcomes than in patients with favorable outcomes.
3 4
[57] 52 [31] 81
chronic subcortical stroke unilateral stroke
Cross-
52 sectional > 3m
FMA FMA
ICA based:15 networks
Decreased FC between the ipsilesional SMN and the contralesional SMN and AN.
5
[83] 76
unilateral stroke
Cross- from 7d 55 sectional to 1m
NIHSS; FMA
Seed-based: predefined 6 ROIs( left M1, right M1, left PMC, right PMC, left SMA, and right SMA).
6
[127] 37
ischemic stroke
Cross-
- sectional 3d;90d
NIHSS(at 3d); mRS(90d)
Atla-based: Harvard-Oxford
7
[125] 41
ischemic stroke
Cross-
- sectional 2-5d;
NIHSS; mRS(90d)
Atla-based:three atlas: Destrieux, Harvard-Oxford and AAL atlas
The worse outcome showed higher values of characteristic path-length.
8
[128] 24
chronic supratento- rial stroke
Cross-
- sectional >2M
FMA
ICA based:16 regions: supplementary motor area (SMA); left dorsolateral prefrontal cortex (DLPFC); right frontoparietal network; left frontoparietal network; cerebellum;
The internetwork connectivity was significantly increased in the mild group for SMA–M1 in the affected hemisphere and SMA–dorsolateral prefrontal cortex DLPFC in the unaffected hemisphere and for lesion–M1 in the unaffected hemisphere compared with the severe group;Increased internetwork connectivity between remote brain regions may result in the reorganization associated with motor recovery. Whole-brain Interhemispheric homotopic functional connectivity, correlated with improvements in Upper-extremity function. The degree of integration within networks and segregation between networks were significantly reduced sub-acutely but partially recovered by 3 months and 1 year; network recovery not correlated with recovery from motor.
9
[129] 42
chronic
Cross-
- sectional >2w
NIHSS;FMA
Atla-based;
10
[118] 65
Stroke
Longitudi-
25 nal 2w;3m;1y
Action Research Arm Test; Func- tional Indepen- dence Measures walk test;
Atla-based:324 regions of interest
11
[74] 8
Stroke
Longitudi- 1w; 2w; 10 nal 1m; 3m;
Motricity Index; NIHSS
Seed-based: ROIs in sensorimotor regions (SMC, inferior parietal lobule) and non-sensorimotor regions(DLPFC)
Between the contralesional SMC and ipsilesional SMC, FC decreased in the first 2 weeks and followed by increases towards normal levels.
Studies Sub. [106] 34
Stoke Info.
Ctrl. Type Timing
Func.Assessment. NIHSS; FMA.
sFC Method
Findings
55 Longitudi- 2w,3m nal
Seed-based: Predefined 24 ROIs
FC were weakened 2 weeks post-stroke and strengthened for 3 months.
Increased FC between cM1&cPrG,iM1&iPrG, precuneus& cPMC, iMFG&Precunesu, cCerebellar&cPoG, iPMC&cPrG, &cIPL&I, cSMA&iPrG, cIFG&cMFG, iSMA&iMTG; No significant between sFC and clinical measure. Good functional outcome had greater functional connectivity right temporal lobe and left frontal lobe, between the left temporal lobe and right frontal lobe and between the right temporal and parietal lobes;
1y

Wu et al.
Page 14 of 25
In many studies related to the prediction of motor recovery or outcomes, the in- creased FC is normally associated with minor severity or a better motor functional outcome. In a study that included 34 patients and healthy control, the author found a significantly lower interhemispheric FC in stroke patients compared to healthy controls in the first week, which support the previous common finding. However, after that, the FC continually increased to week 12. The correlation analysis shows that the percentage of FC changes was significantly positive with the improved FMA score from week 1 to week 4 [106]. In an early prediction study [127], 37 stroke pa- tients were scanned on day 3 after stroke, and the fMRI data were used to predict 90-day outcomes. The results show that patients with good outcomes had higher FC than those with poor outcomes. Adding the FC improves the model’s accuracy to 94.7%, reflecting that increased FC plays an essential role in motor recovery. The stroke patients at the chronic stage have a similar increase. In a study with a total of 107 participants, compared to the patients with a completely paralyzed hand, the patients with a partially paralyzed hand had increased FC in the ipsilesional superior temporal gyrus, the ipsilesional middle occipital gyrus and the contrale- sional calcarine [57]. This finding is also enhanced in a larger cohort of patients with ischemic stroke at the acute stage. In a study with 85 stoke acute ischemic patients, the FC between ipsilesional M1 and contralesional PMD in patients with favorable outcomes was significantly greater than with unfavourable outcomes [107], which demonstrate that the increased FC can serve as an independent outcome predictor.
In total, the FC of the motor network is impaired after stroke onset, and the decreased FC is a consistent finding, but the increased FC can be observed. The increased FC is a way of neuroplasticity, which means that the lost FC has tended to grow to the normal level. From the perspective of neural activation, the decreased FC implies the existing pathways are disinhibited in the recruitment stage after stroke [20], and the increased FC shows that the damaged pathways surrounding the lesion area are newly built thus improving motor function.
Dynamic connectivity analysis
For patients with motor dysfunction following stroke, the number of good examples of DFC analysis is not as high as SFC. However, from the existing investigations, we can conclude the following findings.
The temporal variability of FC is altered following stroke.
DFC analysis methods resort to the temporal variability of FC to reveal neural dynamic properties and recovery mechanisms of stroke. The temporal variability between specific regions illustrates the dynamic reconfiguration of the brain sys- tem over time in response to going processing and globally reflects the degree of synchronization between functional areas in the brain. The definitions of temporal variability are variable across studies.
The study [84] calculated the temporal variability between specific regions as the average functional connectivity over different windows. By contrast, the temporal variability of FC in [83] was characterized as the standard deviation of time courses at predefined seed regions across a series of windows. In terms of the difference, Hu et al. in [84] reported a significantly reduced temporal variability in stroke patients

Wu et al.
Page 15 of 25
Table 3 The summary of DFC analysis with fMRI for post-stroke recovery.
Studies Sub. Stoke Ctrl. Type Timing Extraction DFC Method Findings Info. methods.
[83] 19 Ischemic 19 Longitudinal 7d/2w/3m Seed-based: Sliding window FC temporal variability: Reduced tem- stroke AAL 116 ROIs approach; poral variability; Longitudinal increased
over the stages.
    [84]
  75
Ischemic stroke
  55
Longitudinal
  7d-1m
 Seed-based: six ROIs (bi- lateral M1, SMA and PMC )
 sliding window approach; stan- dard deviation
 Increased dynamic FC between the ip- silesional M1 regions and contralesional PrG, and a negative correlation between dFC in the regions and FMA scores after stroke.
 [130]
  31
Ischemic stroke
  17
Longitudinal
  within 2 week
 Voxel-based: spatially constrained ICA:13 net- work compo- nents
 sliding win- dow approach; k-means clus- tering
 Severe subgroup: spatially segregated connectivity configuration; regionally densely connected. increased transition likelihood to this State 1 Moderate: weakly connected configuration (low lev- els of connectivity) spent more time.
 [131]
  41
Ischemic stroke
  -
Cross-sectional
  <7d;>6m
 Voxel-based: ICA (49 to 7 functional domain)
 sliding win- dow approach; k-means clus- tering.
 NIHSS significantly correlated with frac- tion and dwell time of state 1.
 [132]
  54
Ischemic stroke
  -
Cross-sectional
  <7d;>6m
 Voxel-based: ICA(14 to 3 functional domain)
 sliding win- dow approach; sparse inverse covariance ma- trix; k-means clustering.
 Mildly: lower variability values Moderately-to-severely: higher dy- namic connectivity variability fraction and dwell time improve the prediction performance.
    compared to the healthy group; however, the FC temporal variability decreased- regions exhibited disparity at distinct poststroke stages. In the acute stage, the reduced regions cover the primary sensorimotor and default mode network (DMN), while only the ipsilesional PoCG and ipsilesional anterior cingulate gyri (ACG) showed a declining trend in the subacute stage. Nevertheless, this finding is in- compatible with a study [83] finding, where an increased temporal variability in ipsilesional M1 and contralesional PrG was observed. And this increase shows a longitudinal trend, which is exhibited over the stages of stroke.
Taking advantage of the temporal variability, the relationship between dynamic FC and motor function recovery poststroke was investigated in both studies. In [83], the authors detected a significantly negative correlation between FMA scores and FC variability in ipsilesional M1 and contralesional PrG. And in [84], the increased FC variability from the acute to the subacute stage was reported to correlate posi- tively with the increased FMA.
The results across studies appear to be different, or to an extent, the opposite. This exhibits a preference for these publications. It is not expected but can be accepted as the subjects, the stroke severity, the post-stroke stage, the brain motor area, and the algorithm calculating temporal variability are biased in various investigations.
Motor function affected patients alters the preference in transient brain states of sMN
The mutual transition of connectivity state in diseases with highly dynamic neural activity abnormalities has been active research in DFC analysis. The so-called con- nectivity state is generally abstracted from the reoccurring BOLD signal using a sliding window scheme and clustering algorithm. Thus, a successive highly recurrent FC pattern list within an MRI scan can vividly exhibit a dynamic transition be- tween the multiple brain states. This dynamic transition globally reflects the FCN’s flexibility and can be utilized to investive the alteration or adaptation of dynamic interaction between brain functional networks after stroke.
The alteration of connectivity states’ flexibility and adaptation due to cognition and psychiatric disorder has been illustrated in other studies, while stroke-induced changes in brain states have rarely been investigated. Recently, the abnormal con- nectivity states in acute ischemic stroke (AIS) attracted the attention of researchers.

Wu et al.
Page 16 of 25
In a study which included 31 AIS patients [130], the authors outlined three dif- ferent SMN connectivity states: the first is characterized by extremely strong intra- domain connectivity and extremely weak inter-domain connectivity; the second has remarkably weak intra-domain connectivity; and the third is a compound state that combines the characteristics of states 1 and 2. The summarized states do not differ too much from the states summarized in their further work [132][131], while three studies revealed different aspects concerning post-stroke motor impairment. [130] provides the distinct configuration of the FC connectivity states in stroke patients with various degrees of clinical symptoms. Moderately affected patients, for exam- ple, have significantly more dwell time in a weakly connected configuration, while severely affected patients prefer to stay in the state 1. This finding is consistent with the study [132], which included 41 AIS patients. This study also demonstrated that NIHSS significantly correlated with a fraction (the ratio of the time a subject spent in a given state over the scan time) and dwell time (the time a subject spent in a state without switching to another one ) of state 1. [131] has the most AIS patients (54) among the three studies. In this study the author pays more attention to dis- tinguish the link between the SMN connectivity measure and the subgroups with or without the motor deficit. Results show that embedding the fraction and dwell time into the initial motor impairment-based model can improve the prediction performance(95% accuracy).
Note that this finding does not derive from multiple independent investigations. Hence, it needs to be validated in other stroke patient cohorts to test if the results are reliable and reproducible. Additionally, only the SMN has so far shown the preference shift in transitory brain states. If this variance is caused by changes in the globally dynamic interplay between distinct functional domains, this can be further investigated in the future.
Discussion
Search studies in this review demonstrate that the widespread changes in connec- tivity can observed in post-stroke recovery. In a static brain functional network, decreased interhemispheric FC appears to be a common feature of resting-state network reorganization in stroke, accompanied by reduced network efficiency and modularity. Increased FC can be also observed, and a positive correlation exists between the increased FC of bilateral cerebral hemispheres and the degree of post- stroke functional recovery. On the other hand, the DFC analysis reveals that the FC temporal variability has a decreased trend, and abnormal connectivity states exist in post-stroke patients with motor impairment. Despite DFC analysis is not as ma- ture as SFC in poster-stroke investigation, DFC methods reveal the dynamic nature of brain, bringing an all-new perspective to investigate the recovery mechanism.
In the following, we continue to discuss two interesting aspects pertinent to SFC and DFC analysis following stroke: 1. if the static or dynamic functional connectivity can sever as a post-stroke recovery biomarker; 2. the methodological considerations relevant to functional connectivity analysis in stroke research.
Static or dynamic functional connectivity as a recovery biomarker following stroke
Accurate prediction of motor function outcomes and treatment responses after stroke can benefit clinical and research settings, promoting effective rehabilitation

Wu et al.
Page 17 of 25
care delivery and the stratification of subjects in clinical trials. As a heterogeneous disease, stroke is characterized by the varying lesion size and location. Therefore, the demographic and clinical variables, such as age, sex, lesion volumes, etc., are nat- urally considered potential factors contributing to the post-stroke recovery predic- tion [133, 134]. Recently, there has been increasing interest in the role of functional connectivity measurements acquired from neuroimaging in predicting recovery per- formance. Hence, in this section, we discuss if the SFC and DFC measurements can serve as a motor recovery biomarker following a stroke from the perspective of FC application.
An appropriate first step to investigating the role of FC measures in motor recov- ery after stroke is to examine the strength of the association between connectivity and motor behaviour in different stroke populations. A correlation coefficient of 0.75 or greater usually indicates a strong correlation. Results from cross-sectional studies showed a moderate to a strong association between measures of static func- tional connectivity and motor status after stroke(r =0.58-0.76) [135, 136, 137]. The number of stroke patients studied in these studies ranged from 8 to 55. The mo- tion Assessment was measured using the Upper Extremity Fugl-Meyer assessment (UL-FMA) scores, Motricity Index, and Chedoke-McMaster Stroke Assessment.
Regarding DFC analysis, the dynamic FC measure – temporal variability demon- strates a significant correlation with the UL-FMA scores at the chronic stage after stroke, showing the same effect as static FC analysis [84]. Another DFC study found a negative correlation between the difference in DFC measures in the motor execu- tion network and FMA scores [83], while it did not pass through FDR correction. In addition, in a study with 31 acute ischemic stroke patients [130], dynamic functional connectivity pattern shows significant differences between stroke groups varying in motor status: patients with severely impaired mobility are more likely to have a regionally dense connected, highly segregated pattern; patients with mild motor impairment take more time to weakly connect the state with reduced segregation.
The results from the longitudinal studies also appear to underpin FC as a potential biomarker for post-stroke motor recovery. For example, in the longitudinal study of static FC in stroke patients, initial baseline measures of functional connectivity were strongly associated not only with longitudinal temporal assessment scores of motion status [28, 138], but also strongly correlated with changes in motor function recovery over time (motor function improvement, r = 0.32 - 0.79) [139, 140, 124, 106]. Dynamic analysis of FC at the longitudinal level further demonstrated the potential of FC alteration as a biological marker of rehabilitation (between bilateral intraparietal lobule and left angular gyrus, r = -0.68) [132].
With support from the literature findings, FC substantiates that it can serve as a reliable biomarker for post-stroke motor recovery. However, it is advised to keep cau- tion to assess the causality relationship between functional connectivity and stroke recovery— the sample size and statistic capability bring more challenges to FC as a crucial factor in post-stroke recovery. On the one hand, sample sizes collected in clinical analyses typically range from 10 to 20 participants, which is particularly to sensitive to outliers [141] and vulnerable to the effective size inflation [142], may not accurately represent the entire group. On the other hand, the operation of co- variables, such as age, sex, lesion size/location, baseline motor status/measure, etc.,

Wu et al.
Page 18 of 25
is various across studies, intensifying inconsistent FC recognition in stroke recovery. Nonetheless, we should not be too pessimistic. Despite these criticisms being fair, it does not change the strong or the strong versus weak FC effects observed in the recovery process. [143]. In the future, longitudinal studies with more samples or the clinical benefits of the function outcome prediction may underpin the role of FC in post-stroke recovery.
Methodological considerations relevant to functional connectivity analysis in stroke research
Generally, two experimental designs are involved in stroke research with the FC analysis: cross-sectional and longitudinal. These two study designs allow investiga- tion of different post-stroke effects on FC. Typically, a cross-sectional study exam- ines the FC change between stroke-health control (between-person effects); a longi- tudinal study can peek at the FC change in stroke patients over time (within-person effects) [144]. Due to intensive time and resource payment, the majority of studies rely on cross-sectional designs. However, one of the defects of the cross-sectional study is the brain lesion-induced FC difference will be diluted by the cohort effects. For instance, since the life backgrounds vary in participants, FC differences between stroke patients and healthy will reflect not only the lesion-induced neural circuits reorganization, but also differences in the environment participants live. To track the within-person FC changes in post-stroke recovery and to investigate the causal- ity of FC and neuroplasticity, a longitudinal study is a potent method that can demonstrate the cross-sectional findings from the time dimension [120, 28, 106]. In the cross-sectional studies, static and dynamic FC analyses are present, while the static accounts for the majority in longitudinal studies. Recently, dynamic connec- tivity analysis has been developed in multiple fields [145, 93, 104, 146, 144]. Since post-stroke recovery is time-dependent, investigating how the neural networks inter- act dynamically and to what extent dynamic connectivity pattern supports motor function recovery and change deserves further study.
Section II introduces the general pre-processing methods. Although pre-processing steps involve choices between analysis approaches(static vs dynamic), they only vary mildly across FC analysis investigations for post-stroke research. And as far as to our knowledge, the systemic study of the effects of pre-processing choices has been not proposed. That is probably because the sample size of stroke patients is not huge, which cannot support examining the pre-processing steps on the lesion-induced difference in functional connectivity.
In terms of the brain parcellation methods they use, SFC and DFC studies have apparent preferences. Post-stroke studies with SFC analysis commonly use the atlas- based method to parcellate the whole brain. This brain map generated from massive brain investigation can provide detailed brain information allowing researchers to focus on the interested network or regions. Besides, one of the biggest benefits of using the atlas-based method is that it provides a way to compare and get fairly consistent findings across studies; for example, the lesions interrupt the remote net- work connection, and the interhemispheric FC decrease, etc. By contrast, studies with DFC tend to utilize the ICA since the DFC is more sensitive to noise due to increased temporal resolution. Hence, the results of DFC’s approach may vary

Wu et al.
Page 19 of 25
depending on the patient cohorts because the ICA is a data-driven approach which may isolate components belonging to different networks. Moreover, compared with the altas-based method, ICA cannot examine changes in interhemispheric connec- tions. Hence, how connections between hemispheres interact dynamically at the millisecond level may require combining the SFC and DFC results or new interven- tion approaches.
Conclusion
fMRI based post-stroke functional connectivity analysis for post-stroke motor dys- function patients has two branches: the static functional connectivity(SFC) and dynamic functional connectivity analysis (DFC). While SFC assumes that the FC/FNC is stationary during the fMRI scan, DFC maintains that the FC/FNC fluctuates even for a short period of time and has a specific coupling pattern. A great many of SFC and DFC analysis methods have been developed and success- fully applied to investigate the alteration of functional interaction or communication behind post-stroke motor function deficit and recovery. In this context, this review summarized the current advance of SFC and DFC approaches and latest findings for their application on post-stroke motor function research. The studies included in this review demonstrate that SFC is the predominant post-stroke functional con- nectivity analysis method in last five fears. The results from SFC show that there is a reduction in FC between motor regions after a stroke, that a rise in FC is highly associated with functional recovery. Meanwhile, DFC is developing rapidly. the ap- plication of DFC methods in post-stroke motor function impairment and recovery has shown its potential. With more DFC methods created and utilized to investi- gate the abnormal motor FC/FNC dynamics, the DFC is expected to far reaching effects in term of neural reorganization underlying stroke recovery and underpin understanding of the recovery mechanism.
Besides, based on the consideration of the previous studies, recommendations from this review of future studies are:
1 Both SFC and DFC methodology needs to be validated on large cohort to improve reliability and robustness of their statistic results.
2 As a potent method to examine the stroke lesion-effect to FC/FNC dynamics alteration within-person, DFC method based longitudinal post-stroke investi- gation should be greatly encouraged in the future.
3 The quantitative relationship between FC/FCN alteration and motor function improvement should thoroughly investigated, particular for dynamic FC/FNC alteration.
4 The post-stroke motor function research should not limit to brain motor func- tion areas. The interplay effect between motor network and other function network like the cognitive network should be considered.





Acute ischemic stroke lesion segmentation in non-contrast CT images using 3D convolutional neural networks
A.V. Dobshik1, S.K. Verbitskiy1, I.A. Pestunov2, K.M. Sherman3, Yu.N. Sinyavskiy2, A.A. Tulupov3 , V.B. Berikov1,4 1Novosibirsk State University, Novosibirsk, Russia 2Federal Research Center for Information and Computational Technologies, Novosibirsk, Russia 3International tomography center SB RAS, Novosibirsk, Russia 4Sobolev Institute of mathematics SB RAS, Novosibirsk, Russia
Abstract
In this paper, an automatic algorithm aimed at volumetric segmentation of acute ischemic stroke lesion in non-contrast computed tomography brain 3D images is proposed. Our deep-learning approach is based on the pop- ular 3D U-Net convolutional neural network architecture, which was mod- ified by adding the squeeze-and-excitation blocks and residual connections. Robust pre-processing methods were implemented to improve the segmen- tation accuracy. Moreover, a specific patches sampling strategy was used to address the large size of medical images, to smooth out the effect of the class imbalance problem and to stabilize neural network training. All experi- ments were performed using five-fold cross-validation on the dataset contain- ing non-contrast computed tomography volumetric brain scans of 81 patients diagnosed with acute ischemic stroke. Two radiology experts manually seg- mented images independently and then verified the labeling results for incon- sistencies. The quantitative results of the proposed algorithm and obtained segmentation were measured by the Dice similarity coefficient, sensitivity, specificity and precision metrics. Our proposed model achieves an average Dice of 0.628±0.033, sensitivity of 0.699±0.039, specificity of 0.9965±0.0016 and precision of 0.619 ± 0.036, showing promising segmentation results.
1
arXiv:2301.06793v1 [eess.IV] 17 Jan 2023
Keywords: ischemic stroke, brain, non-contrast CT, segmentation, CNN, 3D U-Net.
Citation: Dobshik AV, Verbitskiy SK, Pestunov IA, Sherman KM, Sinyav- skiy YuN, Tulupov AA, Berikov VB, Acute ischemic stroke lesion segmen- tation in non-contrast CT images using 3D convolutional neural networks. Computer Optics 20XX; 4X(X): XXX-YYY. DOI: 10.18287/2412-6179-CO- editorial index.
Introduction
Acute cerebral circulation disorder or stroke is a disease with high rates of morbidity and mortality worldwide. According to the American Heart Association, the most common type of stroke is ischemic [1]. Early diagnosis of stroke is crucial for treatment choice [2,3], because tissue changes in the ischemic penumbra may be reversible, especially in the early stages [4,5]. The choice of diagnostic methods in each specific case strongly depends not only on its applicability (availability, contraindications, patient’s condition, etc.), but also on the time of symptoms onset [6]. Any delay in medical care increases the risk of severe consequences and death.
Neuroimaging is fundamental to most modern methods of differential di- agnosis of acute stroke [5,7–12]. For some imaging procedures, contrast in- jection is required, which is related to the risk of complications and a number of contraindications. The analysis of Computed Tomography (CT) and Mag- netic Resonance Imaging (MRI) scans is an integral part of the examination guidelines for patients with signs and symptoms of acute stroke [7–9].
CT is the most common diagnostic tool for acute ischemic stroke (AIS) due to its availability (a large number of screening centers, low cost, no contraindications and low body burden) and short screening duration [7,8, 13]. Non-contrast CT (NCCT) was first used in the evaluation of AIS patients in 1995 to detect intracranial hemorrhage (hemorrhagic stroke) and select a treatment strategy at an early time window (within 3 hours of symptoms onset) [15,16] and proved to be efficient [13,14,17]. When diagnosing stroke, NCCT demonstrates relatively high specificity and low sensitivity, however, it allows detecting blood clots in cerebral vessels and intracranial hemorrhage (hemorrhagic stroke) which are absolute contraindications for some strategies of AIS treatment [9,17].
Interpretation of NCCT scans is associated with certain difficulties, since early AIS changes look like areas of slightly reduced density, which the hu- man eye due to various factors cannot always distinguish from the normal tissues [3,7,19]. In addition, images often show artefacts (caused by patient movements or imaging camera) that may look like strokes [8]. Therefore,
2
  
developing of automated procedures for localization and assessment of AIS tissues volume based on NCCT scans [19–26] (including the procedures based on convolutional neural networks (CNNs) [19–22]) is an urgent task. Ran- domized controlled trials [19,27–29] have shown that CNN-based methods are comparable to radiologists in terms of sensitivity, specificity, overall accuracy, AUC, ROC, etc. It allows using CNNs as auxiliary tool in clinical practice. In addition, automated processing based on 3D CNNs allows volumetric anal- ysis taking into account the spatial context and the rapid detection of small ischemic foci.
Over recent years in the medical image segmentation task CNNs have achieved state-of-the-art results [30,31]. It is due to the convolution operation and its weights capable of learning complicated structures and patterns at multiple scales in the data. The U-shaped encoder-decoder CNN architecture 2D U-Net [32] has a wide application [33–35]. In [33], a self-adapting frame- work where 2D U-Net is adopted to segment various organs is proposed. For the analysis of volumetric images, 3D CNNs were introduced [36–38]. 3D U- Net [36] shows better performance in comparison with 2D U-Net. In [39], a slightly modified 3D U-Net is utilized for brain tumor segmentation in MRI scans. In [40] DeepMedic CNN architecture [38] is used for stroke lesions seg- mentation and post-processing techniques are investigated. In [33], cascaded 3D U-Net is proposed, which overcomes the disadvantage of 3D U-Net for datasets with large image sizes, but it requires training two neural networks. U-Net is often improved for a specific task using various architecture choices (e.g., Squeeze-and-Excitation blocks [34,41–43], attention mechanisms, and computer vision transformers [44]).
In this work, we present a neural network algorithm for the volumetric segmentation of acute ischemic stroke lesions on NCCT brain images. We use a 3D CNN based on 3D U-Net architecture [36], which we modify with residual connections and relatively new Squeeze-and-Excitation blocks [41]. To achieve better results, we implement robust pre-processing techniques, a particular patch extraction strategy, and a weighted loss function, which are aimed to alleviate the problem of class imbalance. We perform five-fold cross-validation and compare the results of experiments by measuring Dice, sensitivity, specificity, and precision metrics.
In the rest of the paper, we describe the used dataset and the method (including data pre-processing techniques and patches sampling strategy), the neural network architecture, and training and testing procedures. In the end, we summarize our work and discuss future plans.
1. Materials
The dataset used for our study contains volumetric non-contrast CT head 3

scans of 81 patients diagnosed with acute ischemic stroke. The CT images were made by the Philips Ingenuity CT scanner and stored in medical DI- COM format. The data were acquired from the International Tomography Center SB RAS. All volumetric images have the same resolution of 512×512, but a different number of slices varying from 306 to 505, depending on the patient. For all images, slice thickness and spacing between slices are 1 and 0.5 mm, respectively. Also, the DICOM attribute pixel spacing, that is, the physical distance in mm between pixel centers, ranges from 0.38 to 0.5 for different volumes. For each volumetric image, corresponding manual segmentation is available. All segmentations were performed by two radiol- ogy experts (specialists in magnetic resonance imaging and X-ray computed tomography with 9-13 years experience, PhD in Radiology and Radiation Therapy) using 3D Slicer [45]. It is worth mentioning that the number of voxels corresponding to the area affected by acute ischemic stroke is 0.8% of the total number of voxels in our dataset.
2. Methods
2.1. Data pre-processing
One crucial step in all deep-learning approaches is data pre-processing, which ensures data consistency. Training CNN directly on data without pre-processing leads to poor performance, as will be shown below. First, the intensities of CT images were thresholded between 0 and 80 Hounsfield units [46]. This transformation eliminates most of the artifacts and high- intensity tissues and remains visible such important parts of the brain as soft tissue, white matter, and gray matter. Second, the skull and coil were removed on each slice, leaving only the brain area on the CT image. This transformation was performed using connected component analysis. In par- ticular, extraction of the largest connected component, then assigning zero values to pixels with the highest intensity, which correspond to the region of the skull, and re-extraction of the largest connected component. Third, each volume was normalized. We apply min-max normalization:
X􏰃= X−Xmin Xmax − Xmin
where Xmin and Xmax are the minimum and the maximum intensity values (X) of 3D image, respectively. Such a normalization rescales values to [0,1]. We also conducted an experiment applying standardization before min-max normalization:
X􏰂 = X − μ s
4
  
  (a) (b)
Fig. 1. (a) CT image after the first pre-processing step, (b) after pre- processing
where μ is the mean and s is the standard deviation of the brain region. Standardization was applied to each volumetric CT image of each patient independently. Also, the non-brain region was set to 0. Such a technique gives comparative intensity values in the brain area while invariant to the size of the background part. Fourth, the volumes were cropped to the non-zero region to dispose of a large uninformative background area. An example of a pre-processed image is shown in Figure 1.
2.2. Patch-based approach
The main difficulty related to 3D medical images is their large size, while computing resources are always limited. For example, a CT scan from our dataset has on average 512 × 512 × 405 = 106168320 voxels (1.04 GB of memory for 32-bit voxels), where 405 is the average number of slices for a patient. It is worth noting that if the dataset is anisotropic, that is, the resolution of different axes of an image is not the same, resizing methods are not advisable. Different interpolation techniques can deform the physical object and remove small details.
An optimal solution is to extract small parts, so-called patches, of 3D images and use them as input to a neural network. We use the uniform sam- pler, which extracts patches randomly from the whole volume with uniform distribution, and the weighted sampler, which extracts patches from different parts of the volume with a given non-uniform distribution. In our case, the weighted sampler extracts a patch with its center in the area of the healthy brain tissue with a probability of 0.5 and with its center in the area affected by the stroke with a probability of 0.5. The probability of the background
5

as a patch’s center is set to 0. During one training epoch, the same number of patches set to 32 are extracted for each patient. The patch size is set to 128×128×128.
2.3. Neural network architecture
Our deep learning algorithm builds on the encoder-decoder 3D U-Net [36] convolutional neural network, which we specially modify for our objective. The architecture of the neural network is shown in Figure 2. The input size is 128 × 128 × 128. Each convolutional block of encoder and decoder consists of two 3D convolutions with the size of kernel 3 × 3 × 3 and stride of 1 × 1 × 1, where each of them is followed by a normalization layer and activation function. We adopt LeakyReLU as an activation function since it showed better results in our experiments in comparison with more commonly used ReLU.
Fig. 2. CNN architecture
It is known that batch normalization [47] is strongly contingent on the current batch statistics during training. The statistics can include some noise, depending on the input examples. Therefore, it requires a sufficiently large batch size and also a large size of the training set. However, due to the high memory usage of 3D convolutions when employing large patches, we are limited to a maximum batch size of 2. Thus, we apply instance normalization, which solves this issue and shows better performance in our task than batch normalization.
Trilinear upsampling is used instead of the more traditional transposed convolution operator in the decoder part. In our research, we observe similar
6
 
results, but the upsampling operator has no trainable parameters, so the occupied memory can be reduced.
Residual connections mitigate the problem of vanishing and exploding gradients when training deep neural networks. It was first proposed in ResNet [48]. We integrate this technique in each convolution block of the contracting and expansive paths. The input is processed by 3D convolution with a kernel size of 1 × 1 × 1, so the element-wise addition is possible. The architecture diagram of the convolutional block of the encoder with resid- ual connection is illustrated in Figure 3. The parameters in brackets after Conv3D are the number of input channels, output channels, and kernel size. The decoder block is similar except for trilinear upsampling that halves the number of channels instead of 3D convolution that doubles the number of channels, therefore we leave aside the decoder block image.
We insert the Squeeze-and-Excitation (SE) mechanism [41] in our CNN as it shows strong performance in many computer vision tasks. It squeezes the global spatial information into a channel descriptor, captures inter-dependen- cies of all channels, and then recalibrates the feature maps to accentuate relevant channels. In our case, it can help to learn where the affected area is located by strengthening the informative features and suppressing the weak ones.
Channel-wise global average pooling is applied to the input tensor T ∈ RC×D×H×W of the SE block. Then the obtained vector U ∈ RC is processed by the excitation mechanism:
S=σ(W2·δ(W1·U)), S∈RC
where W1 ∈ RCr ×C is a linear layer reducing the number of dimensions of the vector U , δ is the ReLU activation function, W2 ∈ RC × Cr is a linear layer increasing the number of dimensions of the vector U, σ is the sigmoid function, and r is a parameter. In the end, a channel-wise multiplication between each element si of the vector S and the input tensor T is performed. SE module is integrated into each convolutional block. Its particular location is shown in Figure 3.
2.4. Training procedure
The obtained segmentation maps from the last CNN layer are transformed by the sigmoid function to get the probabilities of classes. Then the neural network weights are optimized using the sum of binary cross-entropy (BCE) and soft Dice [49] loss functions. We also perform experiments with weighted
7

 Fig. 3. Convolutional block of the encoder
BCE loss since it addresses the class imbalance problem:
N
L=􏰁wi(−yilogpi −(1−yi)log(1−pi))+(1−
i=1
wi = N0yi +N1(1−yi) N
where N0 is the number of background pixels of all training images, N1 is the number of pixels related to the affected area, N = N0 + N1, yi and pi denote the ground truth and the confidence score of the model for pixel i, respectively.
2.5. Training, implementation and testing details
We train our networks using the following setting: the batch size of 2, Adam optimizer [50] with the initial learning rate of 1E-4, which is reduced by factor 2 every 5000 iterations until the learning rate is 1.25E-5, L2 weight decay of 1E-5. The reduction ratio r of SE is 16. Each model was trained for a total of 40000 iterations.
The proposed algorithm was implemented in Python 3.7 using PyTorch 1.12.0 machine learning framework. We also employ TorchIO 0.18.80 [51]
8
N
2􏰀piyi +ε
i=1 ), NN
􏰀 p 2i + 􏰀 y i2 + ε i=1 i=1
  
Python library for data pre-processing. All trainings were conducted on NVIDIA Tesla T4 GPU with 16 GB of memory.
All patients were randomly split into five parts, so all experiments were performed using five-fold cross-validation. To evaluate our results, we mea- sure Dice similarity coefficient (DSC), sensitivity, specificity, and precision metrics, which are most significant in medical image segmentation. The use of these metrics, in addition to the main metric DSC, allows us to evaluate aspects of the behavior of segmentation methods in conditions of unbal- anced samples. Results are presented as mean ± standard deviation. DSC is calculated similarly to the soft Dice loss but is not subtracted from 1 and thresholded values are used instead of confidence scores. To get the predicted binary segmentation mask, the obtained probabilities were binarized accord- ing to the threshold of 0.5. On the test set, patches were extracted across a whole volume with an overlap of 25% over a grid. The predictions in the overlapping areas were averaged.
3. Experiments and results
The quantitative comparison of our methods is presented in Table 1. The pre-processing of the first experiment included only thresholding of the Hounsfield units and the min-max normalization. Also, patches were derived
 Method
No pre-processing Pre-proccesing
Table 1. Cross-validation results
DSC Sensitivity Specificity Precision 0.508 ± 0.037 0.597 ± 0.09 0.9975 ± 0.0014 0.519 ± 0.057
0.511 ± 0.023 0.518 ± 0.035 0.9980 ± 0.00092 0.617 ± 0.038
    Pre-processing + weighted sampler
 0.547 ± 0.025
  0.567 ± 0.076
0.9975 ± 0.0016
  0.616 ± 0.069
 Pre-processing + weighted sampler + residual connections
 0.574 ± 0.016
  0.606 ± 0.064
0.9975 ± 0.0013
  0.615 ± 0.049
 Pre-processing + weighted sampler + residual connections + SE
 0.612 ± 0.064
  0.689 ± 0.059
0.9965 ± 0.0020
  0.619 ± 0.044
 Pre-processing + standardization + weighted sampler + residual connections + SE +
weighted loss
 0.628 ± 0.033
  0.699 ± 0.039
0.9965 ± 0.0016
  0.619 ± 0.036
    9

25 45 50 90 75 440
0.628±0.033 0.699±0.039 0.9965±0.0016 0.619±0.036 0.622±0.022 0.693±0.047 0.9965±0.0016 0.629±0.036 0.630±0.025 0.693±0.049 0.9965±0.0016 0.638±0.030
Table 2. The comparison of the patch overlap sizes
   Overlap size, %
 Time per patient, s
 DSC
 Sensitivity
Specificity
  Precision
    using the uniform sampler. The results of the second experiment show that adding the robust pre-processing techniques, including selecting the brain tissue and cutting to the non-zero region, increases DSC by 0.4%. The re- stricted patch extraction method performed by the weighted sampler during training improves performance by 3.6% of DSC and 4.9% of sensitivity. The main proposed modifications of 3D U-Net are residual connections and SE. While the integration of the residual connections improves the DSC by 2.7%, the consistent inserting of the SE modules gives a 3.8% of DSC increase, also showing the promising sensitivity value of 0.689 ± 0.059. The final algorithm configuration maintains the above-described improvements, while also stan- dardization before min-max normalization and training using the weighted loss function are performed. Such a configuration gives the best results, 0.628 ± 0.033 of DSC and 0.699 ± 0.039 of sensitivity.
We also study how the patch overlapping size impacts the segmentation accuracy when performing testing. Table 2 shows the quantitative assess- ment with 25%, 50%, and 75% path overlapping using the final algorithm configuration. Although the overlapping of 75% gives the best results relying on DSC, it reduces sensitivity, and the running time of the algorithm per one patient is increased by 10 times.
We tried to insert in the training process various augmentation tech- niques, such as random affine transformation, random flip, random elastic deformation, random gamma intensity transformation, but it worsened the performance of our algorithm.
Qualitative results are presented in Figure 4. Several axial plane slices of the 3D images are from the validation set.
Conclusion
In this work, we presented and evaluated an automatic algorithm for the segmentation of acute ischemic stroke lesion in non-contrast computed tomography brain images. Our deep learning approach is based on the 3D U-Net convolutional neural network. As far as we know, no previ- ous research has investigated the combination of 3D U-Net, Squeeze-and- Excitation blocks, residual connections, specific patch extraction technique,
10

and weighted loss function for solving the problem of acute ischemic stroke lesion segmentation on NCCT images. We have experimentally shown that the suggested pipeline for NCCT images segmentation, as compared to other state-of-the-art methods, improved segmentation performance by implement- ing robust pre processing techniques, Squeeze-and- Excitation blocks, and residual connections. Also, specific patch extraction technique and weighted loss function partially solved the class imbalance problem and increased the segmentation accuracy. Our proposed model showed an average Dice of 0.628 ± 0.033, sensitivity of 0.699 ± 0.039, specificity of 0.9965 ± 0.0016, and precision of 0.619 ± 0.036. High specificity values are caused by the dominance of the negative class (non-affected tissue) over the positive class (pathological area) in the sample. The method can be used by radiologists in delineating between damaged and healthy brain tissue and deciding on further treatment. In particular, it can help correct inaccuracies in their stroke area predictions. Moreover, the method can assist doctors with the large flow of patients by selecting cases with affected brain areas from normal ones. Thus, doctors first of all examine patients in need of emergency care.
It is also important to note that one of the main constraints of our objec-
Fig. 4. Qualitative segmentation results
11
 
tive is the small amount of data in our dataset. It is with this we associate the unusual obtained values of the specificity metric, and with the class im- balance problem. In the future, we plan to explore other CNN architectures and increase the dataset.



